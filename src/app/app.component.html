<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detectar Versão ECMAScript</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            padding: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #444;
        }
        p, ul {
            font-size: 1.1rem;
        }
        ul {
            list-style-type: square;
            margin-left: 20px;
        }
        .highlight {
            font-weight: bold;
            color: #0056b3;
        }
        .explanation {
            background-color: #eef;
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Detecção de Versão ECMAScript</h1>
    <p><strong>Versão do ECMAScript utilizada no projeto:</strong> <span id="current-ecma" class="highlight">Carregando...</span></p>
    <p><strong>Versões de ECMAScript suportadas pelo navegador:</strong></p>
    <ul id="supported-ecmas">
        <li>Carregando...</li>
    </ul>

    <div class="explanation">
        <h2>Como funciona a detecção:</h2>
        <p><strong>1. Detecção da versão atual do projeto:</strong></p>
        <p>A função verifica se os recursos básicos do ES6 (como <code>arrow functions</code> e <code>classes</code>) podem ser executados. 
        Se forem compatíveis, significa que o projeto está rodando ES6 ou superior.</p>

        <p><strong>2. Detecção de versões suportadas:</strong></p>
        <p>A função testa a presença de recursos específicos introduzidos em cada versão do ECMAScript. Por exemplo:</p>
        <ul>
            <li><strong>ES5:</strong> Verifica se <code>Array.isArray</code> e o objeto <code>JSON</code> estão disponíveis.</li>
            <li><strong>ES6:</strong> Verifica se <code>const</code>, <code>arrow functions</code>, e <code>template literals</code> são suportados.</li>
            <li><strong>ES7 a ES12:</strong> Testa recursos adicionais como <code>Array.prototype.includes</code>, <code>Promise.prototype.finally</code>, e <code>BigInt</code>.</li>
        </ul>
        <p>Cada teste bem-sucedido adiciona a versão correspondente à lista de suportadas.</p>

        <p><strong>3. Atualização do DOM:</strong></p>
        <p>Depois que o navegador carrega a página, os resultados são exibidos diretamente no HTML, substituindo os valores padrão "Carregando...".</p>
    </div>

    <script>
        // Função para detectar a versão do ECMAScript atual no projeto
        function detectCurrentECMA() {
            try {
                // Teste básico de recursos do ES6 (ES2015)
                eval("const x = () => {}; class Test {};");
                return "ES6 ou superior";
            } catch (e) {
                return "ES5 ou inferior";
            }
        }

        // Função para detectar as versões suportadas pelo navegador
        function detectSupportedVersions() {
            const versions = [
                { name: "ES5", test: () => typeof Array.isArray === "function" && typeof JSON === "object" },
                { name: "ES6 (ES2015)", test: () => {
                    try {
                        eval("const x = (a) => a; class Test {} let y = `template`;");
                        return true;
                    } catch {
                        return false;
                    }
                }},
                { name: "ES7 (ES2016)", test: () => typeof Array.prototype.includes === "function" },
                { name: "ES8 (ES2017)", test: () => typeof Object.values === "function" && typeof (async function () {}) === "function" },
                { name: "ES9 (ES2018)", test: () => typeof Promise.prototype.finally === "function" && /(?<=b)a/.test("ba") },
                { name: "ES10 (ES2019)", test: () => typeof Object.fromEntries === "function" && Array.prototype.hasOwnProperty("flat") },
                { name: "ES11 (ES2020)", test: () => {
                    try {
                        eval("BigInt(123); globalThis; null ?? 'fallback';");
                        return true;
                    } catch {
                        return false;
                    }
                }},
                { name: "ES12 (ES2021)", test: () => {
                    try {
                        eval("1_000; let x = { #private: 42 }; x?.#private;");
                        return true;
                    } catch {
                        return false;
                    }
                }},
            ];

            return versions.filter(version => version.test()).map(version => version.name);
        }

        // Atualizar a interface ao carregar o DOM
        document.addEventListener("DOMContentLoaded", () => {
            // Detectar a versão utilizada no projeto
            const currentVersion = detectCurrentECMA();
            const currentVersionElement = document.getElementById("current-ecma");
            currentVersionElement.textContent = currentVersion;

            // Detectar as versões suportadas pelo navegador
            const supportedVersions = detectSupportedVersions();
            const supportedVersionsList = document.getElementById("supported-ecmas");
            supportedVersionsList.innerHTML = ""; // Limpar "Carregando..."

            if (supportedVersions.length > 0) {
                supportedVersions.forEach(version => {
                    const li = document.createElement("li");
                    li.textContent = version;
                    supportedVersionsList.appendChild(li);
                });
            } else {
                const li = document.createElement("li");
                li.textContent = "Nenhuma versão compatível detectada.";
                supportedVersionsList.appendChild(li);
            }
        });
    </script>
</body>
</html>
