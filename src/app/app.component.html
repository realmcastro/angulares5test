<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detectar Versão ECMAScript</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        h1 {
            color: #444;
            text-align: center;
        }
        p {
            font-size: 1.1rem;
        }
        #loader {
            font-style: italic;
            color: #888;
        }
        ul {
            list-style-type: disc;
            margin: 10px 20px;
        }
        li {
            margin: 5px 0;
        }
        .highlight {
            color: #0056b3;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Detecção de Versão ECMAScript</h1>
    <p><strong>Versão do ECMAScript utilizada no projeto:</strong> <span id="current-ecma" class="highlight">Carregando...</span></p>
    <p><strong>Versões de ECMAScript suportadas pelo navegador:</strong></p>
    <ul id="supported-ecmas">
        <li id="loader">Carregando...</li>
    </ul>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            function detectCurrentECMA() {
                try {
                    eval("let x = () => {}; const y = class {}; x();");
                    return "ES6 ou superior";
                } catch {
                    return "ES5 ou inferior";
                }
            }

            function detectSupportedVersions() {
                const versions = {
                    "ES5": function () {
                        return typeof Array.isArray === "function" && typeof JSON === "object";
                    },
                    "ES6 (ES2015)": function () {
                        try {
                            eval("const x = (a) => a; class Test {} let y = `template`;");
                            return true;
                        } catch {
                            return false;
                        }
                    },
                    "ES7 (ES2016)": function () {
                        return typeof Array.prototype.includes === "function";
                    },
                    "ES8 (ES2017)": function () {
                        return typeof Object.values === "function" && typeof async function () {} === "function";
                    },
                    "ES9 (ES2018)": function () {
                        return typeof Promise.prototype.finally === "function" && /(?<=b)a/.test("ba");
                    },
                    "ES10 (ES2019)": function () {
                        return typeof Object.fromEntries === "function" && "flat" in Array.prototype;
                    },
                    "ES11 (ES2020)": function () {
                        try {
                            eval("BigInt(123); globalThis; null ?? 'fallback';");
                            return true;
                        } catch {
                            return false;
                        }
                    },
                    "ES12 (ES2021)": function () {
                        try {
                            eval("1_000; let x = { #private: 42 }; x?.#private;");
                            return true;
                        } catch {
                            return false;
                        }
                    },
                };

                const supportedVersions = [];

                for (let [version, test] of Object.entries(versions)) {
                    if (test()) {
                        supportedVersions.push(version);
                    }
                }

                return supportedVersions;
            }

            // Atualizar a versão do ECMAScript usada no projeto
            const currentVersion = detectCurrentECMA();
            const currentVersionSpan = document.getElementById("current-ecma");
            currentVersionSpan.textContent = currentVersion;

            // Atualizar as versões suportadas no navegador
            const supportedVersions = detectSupportedVersions();
            const ul = document.getElementById("supported-ecmas");
            ul.innerHTML = ""; // Limpar o carregando

            if (supportedVersions.length > 0) {
                supportedVersions.forEach(version => {
                    const li = document.createElement("li");
                    li.textContent = version;
                    ul.appendChild(li);
                });
            } else {
                const li = document.createElement("li");
                li.textContent = "Nenhuma versão compatível detectada.";
                ul.appendChild(li);
            }
        });
    </script>
</body>
</html>
